/*!
 * angular-ui-scroll
 * https://github.com/angular-ui/ui-scroll.git
 * Version: 1.4.1 -- 2016-04-28T12:48:47.609Z
 * License: MIT
 */
!function(){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};angular.module("ui.scroll",[]).directive("uiScrollViewport",function(){return{controller:["$log","$scope","$element",function(a,b,c){var d=this;d.container=c,d.viewport=c,angular.forEach(c.children(),function(a){"tbody"===a.tagName.toLowerCase()&&(d.viewport=angular.element(a))})}]}}).directive("uiScroll",["$log","$injector","$rootScope","$timeout","$q","$parse",function(b,c,d,e,f,g){function h(a,b){return b.after(a),[]}function i(a){return a.element.remove(),a.scope.$destroy(),[]}function j(b,c){if(!p)return h(b,c);if(q){var d=function(){var a=f.defer();return p.enter(b,null,c,function(){return a.resolve()}),{v:[a.promise]}}();if("object"===("undefined"==typeof d?"undefined":a(d)))return d.v}return[p.enter(b,null,c)]}function k(b){if(!p)return i(b);if(q){var c=function(){var a=f.defer();return p.leave(b.element,function(){return b.scope.$destroy(),a.resolve()}),{v:[a.promise]}}();if("object"===("undefined"==typeof c?"undefined":a(c)))return c.v}return[p.leave(b.element).then(function(){return b.scope.$destroy()})]}function l(a,b,c,d){var e=Object.create(Array.prototype);return angular.extend(e,{size:d,reset:function(a){e.remove(0,e.length),e.eof=!1,e.bof=!1,e.first=a,e.next=a,e.minIndex=a,e.maxIndex=a,e.minIndexUser=null,e.maxIndexUser=null},append:function(a){a.forEach(function(a){++e.next,e.insert("append",a)})},prepend:function(a){a.reverse().forEach(function(a){--e.first,e.insert("prepend",a)})},insert:function(d,f){var g=b.$new(),h={item:f,scope:g};if(g[a]=f,c(g,function(a){return h.element=a}),d%1===0)h.op="insert",e.splice(d,0,h);else switch(h.op=d,d){case"append":e.push(h);break;case"prepend":e.unshift(h)}},remove:function(a,b){if(angular.isNumber(a)){for(var c=a;b>c;c++)i(e[c]);return e.splice(a,b-a)}return e.splice(e.indexOf(a),1),k(a)},setUpper:function(){e.maxIndex=e.eof?e.next-1:Math.max(e.next-1,e.maxIndex)},setLower:function(){e.minIndex=e.bof?e.minIndex=e.first:Math.min(e.first,e.minIndex)}}),e}function m(a,b,c,d){function e(){var a=Object.create(Array.prototype);return angular.extend(a,{add:function(b){for(var c=a.length-1;c>=0;c--)if(a[c].index===b.scope.$index)return void(a[c].height=b.element.outerHeight());a.push({index:b.scope.$index,height:b.element.outerHeight()})},clear:function(){a.length=0}}),a}function f(a){var b=void 0;switch(a.tagName){case"dl":throw new Error("ui-scroll directive does not support <"+a.tagName+"> as a repeating tag: "+a.outerHTML);case"tr":var c=angular.element("<table><tr><td><div></div></td></tr></table>");b=c.find("tr");break;case"li":b=angular.element("<li></li>");break;default:b=angular.element("<div></div>")}return b.cache=new e,b}function g(){return n.outerHeight()*Math.max(i,+d.padding||k)}var i=.3,k=.5,l=null,m=null,n=c[0]&&c[0].viewport?c[0].viewport:angular.element(window),o=c[0]&&c[0].container?c[0].container:void 0;return n.css({"overflow-y":"auto",display:"block"}),angular.extend(n,{createPaddingElements:function(a){l=new f(a),m=new f(a),b.before(l),b.after(m)},applyContainerStyle:function(){o!==n&&n.css("height",window.getComputedStyle(o[0]).height)},bottomDataPos:function(){var a=n[0].scrollHeight;return a=null!=a?a:n[0].document.documentElement.scrollHeight,a-m.height()},topDataPos:function(){return l.height()},bottomVisiblePos:function(){return n.scrollTop()+n.outerHeight()},topVisiblePos:function(){return n.scrollTop()},insertElement:function(a,b){return h(a,b||l)},insertElementAnimated:function(a,b){return j(a,b||l)},shouldLoadBottom:function(){return!a.eof&&n.bottomDataPos()<n.bottomVisiblePos()+g()},clipBottom:function(){for(var b=0,c=0,d=0,e=n.bottomDataPos()-n.bottomVisiblePos()-g(),f=a.length-1;f>=0&&(d=a[f].element.outerHeight(!0),!(c+d>e));f--)m.cache.add(a[f]),c+=d,b++;b>0&&(a.eof=!1,a.remove(a.length-b,a.length),a.next-=b,n.adjustPadding())},shouldLoadTop:function(){return!a.bof&&n.topDataPos()>n.topVisiblePos()-g()},clipTop:function(){for(var b=0,c=0,d=0,e=n.topVisiblePos()-n.topDataPos()-g(),f=0;f<a.length&&(d=a[f].element.outerHeight(!0),!(c+d>e));f++)l.cache.add(a[f]),c+=d,b++;b>0&&(l.height(l.height()+c),a.bof=!1,a.remove(0,b),a.first+=b)},adjustPadding:function(b){if(a.length){var c=0,d=0;if(l.cache.length)for(var e=l.cache.length-1;e>=0;e--)l.cache[e].index<a.first&&(c+=l.cache[e].height);if(m.cache.length)for(var e=m.cache.length-1;e>=0;e--)m.cache[e].index>=a.next&&(d+=m.cache[e].height);var f=0,g=0,h=a.minIndexUser&&a.minIndex>a.minIndexUser,i=a.maxIndexUser&&a.maxIndex<a.maxIndexUser;if(h||i){for(var j=0,e=a.length-1;e>=0;e--)j+=a[e].element.outerHeight(!0);var k=(j+c+d)/(a.maxIndex-a.minIndex+1);f=h?(a.minIndex-a.minIndexUser)*k:0,g=i?(a.maxIndexUser-a.maxIndex)*k:0}var o=l.height();if(l.height(c+f),m.height(d+g),b&&h&&f){var p=l.height()-o;n.scrollTop(n.scrollTop()+p)}}},adjustScrollTopAfterPrepend:function(a){var b=l.height()-a;b>=0?l.height(b):(l.height(0),n.scrollTop(n.scrollTop()-b))},resetTopPadding:function(){l.height(0),l.cache.clear()},resetBottomPadding:function(){m.height(0),m.cache.clear()}}),n}function n(a,b,c,e){function f(a,b){if(angular.isArray(b)){var d=void 0,e=c.indexOf(a)+1;b.reverse().forEach(function(b){b===a.item?(d=!0,e--):c.insert(e,b)}),d||(a.op="remove")}}var h=b.scope()||d,i=a.topVisible?g(a.topVisible).assign:angular.noop,j=a.topVisibleElement?g(a.topVisibleElement).assign:angular.noop,k=a.topVisibleScope?g(a.topVisibleScope).assign:angular.noop,l=a.isLoading?g(a.isLoading).assign:angular.noop;this.isLoading=!1,this.applyUpdates=function(a,b){if(angular.isFunction(a))c.slice(0).forEach(function(b){f(b,a(b.item,b.scope,b.element))});else{if(a%1!==0)throw new Error("applyUpdates - "+a+" is not a valid index");var d=a-c.first;d>=0&&d<c.length&&f(c[d],b)}e()},this.append=function(a){c.append(a),e()},this.prepend=function(a){c.prepend(a),e()},this.loading=function(a){this.isLoading=a,l(h,a)},this.calculateProperties=function(){var a=void 0,d=void 0,e=void 0,f=void 0,g=void 0,l=void 0,m=0;for(a=0;a<c.length;a++){if(d=c[a],f=d.element.offset().top,g=l!==f,l=f,g&&(e=d.element.outerHeight(!0)),!(g&&b.topDataPos()+m+e<=b.topVisiblePos())){g&&(this.topVisible=d.item,this.topVisibleElement=d.element,this.topVisibleScope=d.scope,i(h,d.item),j(h,d.element),k(h,d.scope));break}m+=e}}}function o(a,b,h,i,j){function k(){K.bind("resize",z),K.bind("scroll",z)}function o(){K.unbind("resize",z),K.unbind("scroll",z)}function p(){H++,I=[]}function q(){p(),K.resetTopPadding(),K.resetBottomPadding(),arguments.length&&(F=arguments[0]),J.reset(F),w(H)}function r(a){return a.element.height()&&a.element[0].offsetParent}function s(a){r(a)&&(J.forEach(function(a){angular.isFunction(a.unregisterVisibilityWatcher)&&(a.unregisterVisibilityWatcher(),delete a.unregisterVisibilityWatcher)}),w())}function t(a,b){return K.insertElement(a.element,b),r(a)?!0:(a.unregisterVisibilityWatcher=a.scope.$watch(function(){return s(a)}),!1)}function u(a){function b(a){return a>0?J[a-1].element:void 0}var c=!1,d=[],e=[],g=[];if(J.forEach(function(a,f){switch(a.op){case"prepend":e.unshift(a);break;case"append":c=t(a,b(f))||c,a.op="none";break;case"insert":d=d.concat(K.insertElementAnimated(a.element,b(f))),a.op="none";break;case"remove":g.push(a)}}),g.forEach(function(a){return d=d.concat(J.remove(a))}),e.length){var h=0;e.forEach(function(a){c=t(a)||c,a.op="none",h+=a.element.outerHeight(!0)}),K.adjustScrollTopAfterPrepend(h)}return J.forEach(function(a,b){return a.scope.$index=J.first+b}),d.length?f.all(d).then(function(){return K.adjustPadding(),w(a)}):K.adjustPadding(),c}function v(a,b){K.shouldLoadBottom()&&b?1===I.push(!0)&&(y(a),L.loading(!0)):K.shouldLoadTop()&&(b||I[0])&&1===I.push(!1)&&(y(a),L.loading(!0))}function w(a){e(function(){u(a),v(a,!0),I.length||L.calculateProperties()})}function x(a){e(function(){v(a,u(a)),I.shift(),I.length?y(a):(L.loading(!1),k(),L.calculateProperties())})}function y(b){I[0]?J.length&&!K.shouldLoadBottom()?x(b):P(function(c){b&&b!==H||a.$$destroyed||(c.length<E&&(J.eof=!0),c.length>0&&(K.clipTop(),J.append(c),J.setUpper()),x(b))}):J.length&&!K.shouldLoadTop()?x(b):Q(function(c){b&&b!==H||a.$$destroyed||(c.length<E&&(J.bof=!0),c.length>0&&(J.length&&K.clipBottom(),J.prepend(c),J.setLower()),x(b))})}function z(){d.$$phase||L.isLoading||M||(v(H,!0),I.length?o():(L.calculateProperties(),a.$apply()))}function A(a){if(!M){var b=K[0].scrollTop,c=K[0].scrollHeight-K[0].clientHeight;(0===b&&!J.bof||b===c&&!J.eof)&&a.preventDefault()}}var B=h.uiScroll.match(/^\s*(\w+)\s+in\s+([\w\.]+)\s*$/);if(!B)throw new Error("Expected uiScroll in form of '_item_ in _datasource_' but got '"+h.uiScroll+"'");var C=B[1],D=B[2],E=Math.max(3,+h.bufferSize||10),F=parseInt(h.startIndex,10);isNaN(F)&&(F=1);var G=function(){var b=function(){return angular.isObject(d)&&angular.isFunction(d.get)},d=g(D)(a);if(!b()&&(d=c.get(D),!b()))throw new Error(D+" is not a valid datasource");var e=Object.getOwnPropertyDescriptor(d,"minIndex");e&&(e.set||e.get)||Object.defineProperty(d,"minIndex",{set:function(a){this._minIndex=a,N(a)},get:function(){return this._minIndex}});var f=Object.getOwnPropertyDescriptor(d,"maxIndex");return f&&(f.set||f.get)||Object.defineProperty(d,"maxIndex",{set:function(a){this._maxIndex=a,O(a)},get:function(){return this._maxIndex}}),d}(),H=0,I=[],J=new l(C,a,j,E),K=new m(J,b,i,h),L=new n(h,K,J,function(){p(),w(H)}),M=!1,N=function(a){e(function(){J.minIndexUser=a,I.length||K.adjustPadding(!0)})},O=function(a){e(function(){J.maxIndexUser=a,I.length||K.adjustPadding()})},P=function(){return 2!==G.get.length?function(a){return G.get(J.next,E,a)}:function(a){G.get({index:J.next,append:J.length?J[J.length-1].item:void 0,count:E},a)}}(),Q=function(){return 2!==G.get.length?function(a){return G.get(J.first-E,E,a)}:function(a){G.get({index:J.first-E,prepend:J.length?J[0].item:void 0,count:E},a)}}();if(h.adapter){var R=g(h.adapter)(a);angular.isObject(R)||(g(h.adapter).assign(a,{}),R=g(h.adapter)(a)),L=angular.extend(R,L)}j(function(a,c){K.createPaddingElements(a[0]),b.after(a),e(function(){c.$destroy(),a.remove()})}),L.reload=q;var S=function(){return null};h.hasOwnProperty("disabled")&&(S=a.$watch(h.disabled,function(a){a&&!M?M=!0:M&&(M=!1,w())})),a.$on("$destroy",function(){o(),K.unbind("mousewheel",A),S()}),K.bind("mousewheel",A),e(function(){K.applyContainerStyle(),q()})}var p=c.has&&c.has("$animate")?c.get("$animate"):null,q=1===angular.version.major&&angular.version.minor<3;return{require:["?^uiScrollViewport"],transclude:"element",priority:1e3,terminal:!0,link:o}}])}();